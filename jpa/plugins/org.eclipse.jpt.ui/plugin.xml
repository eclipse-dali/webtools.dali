<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.2"?>
<plugin>
	
	<extension-point 
		id="jpaPlatform" 
		name="%JPA_PLATFORM" 
		schema="schema/jpaPlatform.exsd"/>
	
	
	<extension
		point="org.eclipse.core.expressions.definitions">
		
		<!-- 
			A test for determining whether our current context is within the 
			JPA Structure View                                
		-->
		<definition
			id="org.eclipse.jpt.ui.reference.inJpaStructureView">
			<with
				variable="activePartId">
				<equals
					value="org.eclipse.jpt.ui.jpaStructureView"/>
			</with>
		</definition>
		
	</extension>
	
	
	<extension
		point="org.eclipse.core.runtime.adapters">
		
		<factory
			adaptableType="org.eclipse.ui.IWorkbenchPart"
			class="org.eclipse.jpt.ui.internal.selection.SelectionParticipantFactory">
			<adapter type="org.eclipse.jpt.ui.internal.selection.JpaSelectionParticipant"/>
		</factory>
		
		<factory
			adaptableType="org.eclipse.ui.IEditorPart"
			class="org.eclipse.jpt.ui.internal.JpaFileAdapterFactory">
			<adapter type="org.eclipse.jpt.core.JpaFile"/>
		</factory>
		
	</extension>
	
	
<!-- =================================================================================== -->
<!-- Extension: Java Completion Proposal Computer                                        -->
<!-- =================================================================================== -->
	
	<extension
		point="org.eclipse.jdt.ui.javaCompletionProposalComputer"
		id="JpaCompletionProposalComputer">
		<javaCompletionProposalComputer 
			class="org.eclipse.jpt.ui.internal.JpaJavaCompletionProposalComputer"
			categoryId="org.eclipse.jpt.ui.jpaProposalCategory">
			<partition type="__dftl_partition_content_type"/>
			<partition type="__java_string"/>
		</javaCompletionProposalComputer>
	</extension>
	
	
	<extension
		point="org.eclipse.jdt.ui.javaCompletionProposalComputer"
		id="jpaProposalCategory"
		name="%JpaProposalCategory">
		<proposalCategory
			icon="$nl$/icons/full/eview16/jpa_perspective.gif"/>
	</extension>
	
	
	<extension
		point="org.eclipse.jpt.ui.jpaPlatform">
		
		<jpaPlatform
			id="generic"
			class="org.eclipse.jpt.ui.internal.platform.generic.GenericPlatformUi"/>
		
	</extension>
	
	
	<extension
		point="org.eclipse.ui.commands">
		
		<category
			id="org.eclipse.jpt.ui.jpaStructureViewCommands"
			name="%jpaStructureViewCommandCategory">
		</category>
		
		<command
			id="org.eclipse.jpt.ui.entityMappingsAddPersistentClass"
			name="%addPersistentClass"
			categoryId="org.eclipse.jpt.ui.jpaStructureViewCommands">
		</command>
		
		<command
			id="org.eclipse.jpt.ui.persistentTypeRemovePersistentClass"
			name="%removePersistentClass"
			categoryId="org.eclipse.jpt.ui.jpaStructureViewCommands">
		</command>
		
		<command
			id="org.eclipse.jpt.ui.persistentAttributeAddToXml"
			name="%addPersistentAttributeToXml"
			categoryId="org.eclipse.jpt.ui.jpaStructureViewCommands">
		</command>
		
		<command
			id="org.eclipse.jpt.ui.persistentAttributeAddToXmlAndMap"
			name="%addPersistentAttributeToXmlAndMap"
			categoryId="org.eclipse.jpt.ui.jpaStructureViewCommands">
		</command>
		
		<command
			id="org.eclipse.jpt.ui.persistentAttributeRemoveFromXml"
			name="%removePersistentAttributeFromXml"
			categoryId="org.eclipse.jpt.ui.jpaStructureViewCommands">
		</command>
		
	</extension>
	
	
<!-- =================================================================================== -->
<!-- Extension: Persistence Editor                                                  -->
<!-- =================================================================================== -->
	
	<extension 
		point="org.eclipse.ui.editors">
		
		<editor
			class="org.eclipse.jpt.ui.internal.editors.PersistenceEditor"
			contributorClass="org.eclipse.jpt.ui.internal.editors.PersistenceContributor"
			icon="$nl$/icons/full/obj16/jpa-file.gif"
			id="org.eclipse.jpt.ui.internal.editors.PersistenceEditor"
			name="%persistenceEditor">
      		<contentTypeBinding
				contentTypeId="org.eclipse.jpt.core.content.persistence"/>
		</editor>
		
 	</extension>
 	
 	
 	<extension
		point="org.eclipse.ui.handlers">
		
		<handler
			commandId="org.eclipse.jpt.ui.entityMappingsAddPersistentClass"
			class="org.eclipse.jpt.ui.internal.commands.AddPersistentClassHandler">
			<activeWhen>
				<reference
					definitionId="org.eclipse.jpt.ui.reference.inJpaStructureView">
				</reference>
			</activeWhen>
			<enabledWhen>
				<and>
					<count value="1"/>
					<iterate>
						<instanceof value="org.eclipse.jpt.core.context.orm.EntityMappings"/>
					</iterate>
				</and>
			</enabledWhen>
		</handler>
		
		<handler
			commandId="org.eclipse.jpt.ui.persistentTypeRemovePersistentClass"
			class="org.eclipse.jpt.ui.internal.commands.RemovePersistentClassHandler">
			<activeWhen>
				<reference
					definitionId="org.eclipse.jpt.ui.reference.inJpaStructureView">
				</reference>
			</activeWhen>
			<enabledWhen>
				<iterate>
					<instanceof value="org.eclipse.jpt.core.context.orm.OrmPersistentType"/>
				</iterate>
			</enabledWhen>
		</handler>
		
		<handler
			commandId="org.eclipse.jpt.ui.persistentAttributeAddToXml"
			class="org.eclipse.jpt.ui.internal.commands.AddPersistentAttributeToXmlHandler">
			<activeWhen>
				<reference
					definitionId="org.eclipse.jpt.ui.reference.inJpaStructureView">
				</reference>
			</activeWhen>
			<enabledWhen>
				<iterate>
					<and>
						<instanceof value="org.eclipse.jpt.core.context.orm.OrmPersistentAttribute"/>
						<test property="org.eclipse.jpt.core.isVirtual" value="true"/>
						<test property="org.eclipse.jpt.core.isMapped" value="true"/>
					</and>
				</iterate>
			</enabledWhen>
		</handler>
		
		<handler
			commandId="org.eclipse.jpt.ui.persistentAttributeAddToXmlAndMap"
			class="org.eclipse.jpt.ui.internal.commands.AddPersistentAttributeToXmlAndMapHandler">
			<activeWhen>
				<reference
					definitionId="org.eclipse.jpt.ui.reference.inJpaStructureView">
				</reference>
			</activeWhen>
			<enabledWhen>
				<iterate>
					<and>
						<instanceof value="org.eclipse.jpt.core.context.orm.OrmPersistentAttribute"/>
						<test property="org.eclipse.jpt.core.isVirtual" value="true"/>
					</and>
				</iterate>
			</enabledWhen>
		</handler>
		
		<handler
			commandId="org.eclipse.jpt.ui.persistentAttributeRemoveFromXml"
			class="org.eclipse.jpt.ui.internal.commands.RemovePersistentAttributeFromXmlHandler">
			<activeWhen>
				<reference
					definitionId="org.eclipse.jpt.ui.reference.inJpaStructureView">
				</reference>
			</activeWhen>
			<enabledWhen>
				<iterate>
					<and>
						<instanceof value="org.eclipse.jpt.core.context.orm.OrmPersistentAttribute"/>
						<test property="org.eclipse.jpt.core.isVirtual" value="false"/>
					</and>
				</iterate>
			</enabledWhen>
		</handler>
		
 	</extension>
 	
 	
 	<extension
		point="org.eclipse.ui.menus">
		
		<menuContribution
			locationURI="popup:org.eclipse.jpt.ui.jpaStructureView">
			<command
				commandId="org.eclipse.jpt.ui.entityMappingsAddPersistentClass">
				<visibleWhen>
					<with
						variable="selection">
						<iterate>
							<instanceof value="org.eclipse.jpt.core.context.orm.EntityMappings"/>
						</iterate>
					</with>
				</visibleWhen>
			</command>
			<command
				commandId="org.eclipse.jpt.ui.persistentTypeRemovePersistentClass">
				<visibleWhen>
					<with
						variable="selection">
						<iterate>
							<instanceof value="org.eclipse.jpt.core.context.orm.OrmPersistentType"/>
						</iterate>
					</with>
				</visibleWhen>
			</command>
			<command
				commandId="org.eclipse.jpt.ui.persistentAttributeAddToXml">
				<visibleWhen>
					<with
						variable="selection">
						<iterate>
							<and>
								<instanceof value="org.eclipse.jpt.core.context.orm.OrmPersistentAttribute"/>
								<test property="org.eclipse.jpt.core.isVirtual" value="true"/>
							</and>
						</iterate>
					</with>
				</visibleWhen>
			</command>
			<command
				commandId="org.eclipse.jpt.ui.persistentAttributeAddToXmlAndMap">
				<visibleWhen>
					<with
						variable="selection">
						<iterate>
							<and>
								<instanceof value="org.eclipse.jpt.core.context.orm.OrmPersistentAttribute"/>
								<test property="org.eclipse.jpt.core.isVirtual" value="true"/>
							</and>
						</iterate>
					</with>
				</visibleWhen>
			</command>
			<command
				commandId="org.eclipse.jpt.ui.persistentAttributeRemoveFromXml">
				<visibleWhen>
					<with
						variable="selection">
						<iterate>
							<and>
								<instanceof value="org.eclipse.jpt.core.context.orm.OrmPersistentAttribute"/>
								<test property="org.eclipse.jpt.core.isVirtual" value="false"/>
							</and>
						</iterate>
					</with>
				</visibleWhen>
			</command>
			
		</menuContribution>
		
 	</extension>
	
	
	<extension
		point="org.eclipse.ui.navigator.viewer">
		
		<viewerContentBinding
			viewerId="org.eclipse.ui.navigator.ProjectExplorer">
			<includes>
				<contentExtension pattern="org.eclipse.jpt.ui.*"/>
			</includes>
		</viewerContentBinding>
		
	</extension>
	
	
	<extension
		point="org.eclipse.ui.navigator.navigatorContent">
		
		<navigatorContent
			id="org.eclipse.jpt.ui.jpaNavigatorContent"
			name="%jpaNavigatorContent" 
			priority="highest"
			icon="icons/full/obj16/jpa-content.gif"
			activeByDefault="true"
			contentProvider="org.eclipse.jpt.ui.internal.navigator.JpaNavigatorContentProvider"
			labelProvider="org.eclipse.jpt.ui.internal.navigator.JpaNavigatorLabelProvider">
			
			<triggerPoints>
				<and>
					<adapt type="org.eclipse.core.resources.IProject"> 
						<test forcePluginActivation="true"
							property="org.eclipse.wst.common.project.facet.core.projectFacet"
							value="jpt.jpa" />
					</adapt>
				</and>
			</triggerPoints>
			
			<possibleChildren>
				<instanceof
					value="org.eclipse.jpt.core.context.JpaContextNode"/>
			</possibleChildren>
			
			<actionProvider
				class="org.eclipse.jpt.ui.internal.navigator.JpaNavigatorActionProvider"
				id="org.eclipse.jpt.ui.jpaActionProvider">
				<enablement>
					<and>
						<instanceof
							value="org.eclipse.jpt.core.context.JpaContextNode"/>
					</and>
				</enablement>
			</actionProvider>
			
			<!--
			
			<commonSorter
				id="org.eclipse.jst.j2ee.navigator.internal.J2EEViewerSorter"
				class="org.eclipse.jst.j2ee.navigator.internal.J2EEViewerSorter" />
			
			-->
			
		</navigatorContent>
		
	</extension>
	
	
	<extension
		point="org.eclipse.ui.newWizards">
		
		<category
			id="org.eclipse.jpt"
			name="%jpaWizardCategoryName"/>
		
		<wizard
			id="org.eclipse.jpt.jpaProject"
			name="%newJpaProjectWizardName"
			icon="icons/full/etool16/new_jpaproject_wiz.gif"
			category="org.eclipse.jpt"
			class="org.eclipse.jpt.ui.internal.wizards.NewJpaProjectWizard"
			project="true"
			finalPerspective="org.eclipse.jpt.ui.jpaPerspective">
			<description>%newJpaProjectWizardDesc</description>
		</wizard>
		
	</extension>
	
	
	<extension
		point="org.eclipse.ui.popupMenus">
		
		<objectContribution
			id="org.eclipse.jpt.ui.project.JPATools"
			objectClass="org.eclipse.core.resources.IProject"
			adaptable="true">
			<menu
				id="org.eclipse.jpt.ui.project.JPATools"
				label="%jpaMenuName"/>

			<enablement>
					<test property="org.eclipse.wst.common.project.facet.core.projectFacet" value="jpt.jpa"/>
			</enablement>

			<action
				id="org.eclipse.jpt.ui.generateEntities"
				label="%generateEntities"
				class="org.eclipse.jpt.ui.internal.actions.GenerateEntitiesAction"
				enablesFor="1"
				menubarPath="org.eclipse.jpt.ui.project.JPATools/content"/>
			
			<action
				id="org.eclipse.jpt.ui.generateDDL"
				label="%generateDDL"
				class="org.eclipse.jpt.ui.internal.actions.GenerateDDLAction"
				enablesFor="1"
				menubarPath="org.eclipse.jpt.ui.project.JPATools/content"/>
				
		</objectContribution>
		
		<objectContribution
			id="org.eclipse.jpt.ui.project.JPATools"
			objectClass="org.eclipse.core.resources.IProject"
			adaptable="true">
			<menu
				id="org.eclipse.jpt.ui.project.JPATools"
				label="%jpaMenuName"/>
			
			<visibility>
				<and>
					<objectState 
						name="projectNature" 
						value="org.eclipse.jdt.core.javanature"/>
					<not>
						<objectState 
							name="projectNature" 
							value="org.eclipse.wst.common.project.facet.core.nature"/>
					</not>
				</and>
			</visibility>
			
			<action
				id="org.eclipse.jpt.ui.generateDDL"
				label="%migrateJavaProject"
				class="org.eclipse.jpt.ui.internal.actions.MigrateJavaProjectAction"
				enablesFor="1"
				menubarPath="org.eclipse.jpt.ui.project.JPATools/content"/>
				
		</objectContribution>
		
		<objectContribution
			id="org.eclipse.jpt.ui.persistenceXmlFileActions"
			objectClass="org.eclipse.core.resources.IFile"
			nameFilter="persistence.xml">
			<menu
				id="persistenceXmlJPATools"
				label="%jpaMenuName"/>
			<action
				id="synchClassesAction"
				label="%synchronizeClasses"
				menubarPath="persistenceXmlJPATools/content"
				class="org.eclipse.jpt.ui.internal.actions.SynchronizeClassesAction"
				enablesFor="1"/>
		</objectContribution>
		
		<objectContribution
			id="org.eclipse.jpt.ui.persistenceXmlActions"
			objectClass="org.eclipse.jpt.core.context.persistence.PersistenceXml">
			<action
				id="synchClassesAction"
				label="%synchronizeClasses"
				menubarPath="content"
				class="org.eclipse.jpt.ui.internal.actions.SynchronizeClassesAction"
				enablesFor="1"/>
		</objectContribution>
		
	</extension>
	
	
	<extension
		point="org.eclipse.ui.preferencePages">
		
		<page
			id="org.eclipse.jpt.ui.jpaPreferencePage"
			name="%jpaPreferencePage"
			class="org.eclipse.jpt.ui.internal.prefs.JpaPreferencePage"/>
		
	</extension>
	
	<extension
		point="org.eclipse.ui.propertyPages">
		
		<page
			id="org.eclipse.jpt.ui.jpaProjectPropertiesPage"
			name="%jpaProjectPropertiesPage"
			class="org.eclipse.jpt.ui.internal.properties.JpaProjectPropertiesPage">
			<enabledWhen>
				<adapt 
					type="org.eclipse.core.resources.IProject">
					<test 
						property="org.eclipse.wst.common.project.facet.core.projectFacet"
						value="jpt.jpa"/>
				</adapt>
			</enabledWhen>
		</page>
	</extension>
		
	<extension
		point="org.eclipse.ui.views">
		
		<category
			id="org.eclipse.jpt.ui"
			name="%jpaPerspective"/>
		
		<view
	        id="org.eclipse.jpt.ui.jpaStructureView"
	        category="org.eclipse.jpt.ui"
	        class="org.eclipse.jpt.ui.internal.views.structure.JpaStructureView"
	        icon="icons/full/eview16/jpa_structure.gif"
	        name="%jpaStructure"/>
			
		<view
			id="org.eclipse.jpt.ui.jpaDetailsView"
			category="org.eclipse.jpt.ui"
	        class="org.eclipse.jpt.ui.internal.views.JpaDetailsView"
	        icon="icons/full/eview16/jpa_details.gif"
			name="%jpaDetails"/>
		
	</extension>
	
<!-- =================================================================================== -->
<!-- Extension: Persistence Perspective                                                  -->
<!-- =================================================================================== -->
	
	<extension
		 point="org.eclipse.ui.perspectives">
		<perspective
        class="org.eclipse.jpt.ui.internal.perspective.JpaPerspectiveFactory"
        icon="icons/full/eview16/jpa_perspective.gif"
        id="org.eclipse.jpt.ui.jpaPerspective"
        name="%jpaPerspective"/>
	</extension>
	
	<extension
		point="org.eclipse.wst.common.project.facet.ui.images">
		
		<image facet="jpt.jpa" path="icons/full/etool16/jpa_facet.gif"/>
		
	</extension>
	
	
	<extension 
		point="org.eclipse.wst.common.project.facet.ui.wizardPages">
		
		<wizard-pages action="jpt.jpa.install">
			<page class="org.eclipse.jpt.ui.internal.wizards.JpaFacetWizardPage"/>
		</wizard-pages>
		
	</extension>
 	
</plugin>
